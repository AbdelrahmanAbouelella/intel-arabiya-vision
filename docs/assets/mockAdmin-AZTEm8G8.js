const r=t=>new Promise(e=>setTimeout(e,t));let n=[{id:"k-1",label:"Backend service",created_at:new Date().toISOString(),scopes:["read:*"],active:!0,token_preview:"sk_live_ab12cd34"}],c=[];function o(t){c.push({id:"a-"+(c.length+1),at:new Date().toISOString(),ip:"127.0.0.1",ua:"mock",...t})}async function s(){return await r(80),JSON.parse(JSON.stringify(n))}async function y(t,e){await r(150);const i="k-"+(n.length+1),a="sk_live_"+Math.random().toString(36).slice(2,10);return n.push({id:i,label:t,created_at:new Date().toISOString(),scopes:e,active:!0,token_preview:a}),o({actor:"admin@org",action:"apikey.create",entity:"ApiKey",entity_id:i,after:{label:t,scopes:e}}),{id:i,token_preview:a}}async function d(t,e){await r(80);const i=n.find(a=>a.id===t);if(i){const a={active:i.active};i.active=e,o({actor:"admin@org",action:"apikey.toggle",entity:"ApiKey",entity_id:t,before:a,after:{active:e}})}}async function p(t){await r(80),n=n.filter(e=>e.id!==t),o({actor:"admin@org",action:"apikey.delete",entity:"ApiKey",entity_id:t})}async function u(){return await r(80),JSON.parse(JSON.stringify(c.slice(-100))).reverse()}export{y as createApiKey,p as deleteApiKey,s as listApiKeys,u as listAudit,d as toggleApiKey};
